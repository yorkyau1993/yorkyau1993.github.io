<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å…¨æ°‘é˜²è¡›ç”Ÿå­˜æ¸¬é©—</title>
    
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@800;900&family=Noto+Sans+TC:wght@700;900&display=swap" rel="stylesheet">

    <style>
        :root {
            /* æ ¸å¿ƒé¡è‰²ä¸»é¡Œ */
            --theme-bg: #C04000;
            --theme-text-outside: #FFFFFF;
            
            --card-bg: #FFFFFF;
            --card-text: #000000;
            --card-border: #000000;

            --success-bg: #d4edda;
            --success-text: #155724;
            --error-bg: #f8d7da;
            --error-text: #721c24;
            
            --btn-bg: #000000;
            --btn-text: #FFFFFF;
            
            --bad-end-bg: #EE1C25; 
        }

        body {
            background-color: var(--theme-bg);
            color: var(--theme-text-outside);
            font-family: "Noto Sans TC", "Microsoft JhengHei", sans-serif;
            font-weight: 700; 
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            transition: background-color 0.5s;
            -webkit-tap-highlight-color: transparent; /* ç§»é™¤æ‰‹æ©Ÿé»æ“Šè—æ¡† */
        }

        .container {
            width: 100%;
            max-width: 600px;
            padding: 20px;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            flex: 1;
            position: relative;
        }

        /* --- å­—é«”ç‰¹æ®Šè¨­å®š --- */
        #screen-start { font-family: "M PLUS Rounded 1c", "Microsoft JhengHei", sans-serif; }
        .bad-font-style { font-family: "SimHei", "Microsoft YaHei", "STHeiti", sans-serif !important; }

        /* --- å¤–éƒ¨æ–‡å­—æ¨£å¼ --- */
        h1 {
            color: var(--theme-text-outside);
            font-size: 2.8rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 0px rgba(0,0,0,0.2);
            line-height: 1.2;
            text-align: center;
        }
        
        p.subtitle {
            color: var(--theme-text-outside);
            font-size: 1.4rem;
            margin-top: 0;
            margin-bottom: 20px;
            opacity: 0.9;
            text-align: center;
        }

        /* æ¨£å¼åˆ‡æ› */
        body.bad-end { background-color: var(--bad-end-bg); }
        
        .screen { display: none; flex-direction: column; align-items: center; width: 100%; animation: fadeIn 0.4s ease; }
        .active { display: flex; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- å¡ç‰‡æ¨£å¼ --- */
        .card-box {
            background: var(--card-bg);
            color: var(--card-text);
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            border: 2px solid var(--card-border);
            box-shadow: 6px 6px 0px rgba(0,0,0,0.8);
            width: 100%;
            box-sizing: border-box;
            margin-bottom: 20px;
            font-size: 1.1rem;
        }
        
        /* Start Screen Inputs */
        .input-group { margin: 20px 0; text-align: left; }
        .input-group label { display: block; margin-bottom: 10px; color: var(--card-text); font-size: 1.2rem; font-weight: 900; }
        .input-name {
            width: 100%;
            padding: 15px;
            border: 2px solid var(--card-border);
            border-radius: 10px;
            background: #f9f9f9;
            color: var(--card-text);
            font-size: 1.3rem;
            font-weight: bold;
            box-sizing: border-box;
            outline: none;
            font-family: inherit;
        }
        .input-name:focus { box-shadow: 3px 3px 0px rgba(0,0,0,1); background: #fff; }

        /* æŒ‰éˆ•æ¨£å¼ */
        .btn-action, .btn-start {
            background: var(--btn-bg);
            color: var(--btn-text);
            border: 2px solid var(--card-border);
            border-radius: 50px;
            padding: 18px 40px;
            font-size: 1.4rem;
            font-weight: 900;
            cursor: pointer;
            width: 100%;
            margin-top: 15px;
            box-shadow: 4px 4px 0px rgba(0,0,0,0.5);
            transition: 0.1s;
            font-family: inherit;
            /* ç¦æ­¢æ–‡å­—é¸å–ï¼Œå„ªåŒ–æ‰‹æ©Ÿé«”é©— */
            user-select: none; 
            -webkit-user-select: none;
        }
        .btn-action:hover, .btn-start:hover {
            transform: translate(-2px, -2px);
            box-shadow: 6px 6px 0px rgba(0,0,0,0.8);
            background: #333;
        }
        .btn-action:active, .btn-start:active {
            transform: translate(2px, 2px);
            box-shadow: 1px 1px 0px rgba(0,0,0,0.8);
        }
        
        .btn-secondary { background: #fff; color: #000; }

        /* Quiz Screen */
        .header-info {
            display: flex;
            justify-content: space-between;
            width: 100%;
            margin-bottom: 10px;
            font-size: 1.2rem;
            color: var(--theme-text-outside);
            font-weight: bold;
            padding: 0 5px;
        }

        .question-card { position: relative; text-align: left; padding: 30px; }
        .q-cat-label {
            background: #000; color: #fff; font-size: 1rem; padding: 5px 12px; border-radius: 20px;
            display: inline-block; margin-bottom: 20px; font-weight: bold;
        }
        .q-text { font-size: 1.6rem; line-height: 1.4; font-weight: 900; margin-bottom: 10px; color: #000; }
        
        .option-btn {
            background: #fff; border: 2px solid #000; border-radius: 12px; padding: 18px; color: #000;
            margin-bottom: 15px; cursor: pointer; transition: 0.1s; position: relative;
            font-weight: bold; font-size: 1.2rem; box-shadow: 3px 3px 0px rgba(0,0,0,0.1); text-align: left; font-family: inherit;
            /* å„ªåŒ–æ‰‹æ©Ÿé»æ“Š */
            -webkit-tap-highlight-color: transparent;
        }
        .option-btn:active { background: #f0f0f0; transform: translate(1px, 1px); box-shadow: 1px 1px 0px rgba(0,0,0,0.2); }
        .option-btn.correct { background: var(--success-bg); border-color: #006400; color: #004d00; }
        .option-btn.wrong { background: var(--error-bg); border-color: #8b0000; color: #8b0000; }

        .mode-select-btn { flex:1; text-align:center; padding:15px; font-family: inherit; border-radius: 10px; font-size: 1.2rem; }

        /* Result Screen Good */
        .rank-badge { background: #000; color: #fff; padding: 8px 25px; font-weight: 900; display: inline-block; margin-bottom: 15px; border-radius: 30px; font-size: 1.2rem; }
        .score-display { font-size: 6rem; font-weight: 900; color: #000; margin: 10px 0; line-height: 1; }

        /* Result Screen Bad */
        .result-bad { border-width: 4px; box-shadow: 8px 8px 0px rgba(0,0,0,1); }
        .bad-title { font-size: 3rem; font-weight: 900; margin: 10px 0; letter-spacing: 2px; color: #000; }
        .bad-score { font-size: 6rem; font-weight: 900; border-bottom: 5px solid #000; display: inline-block; padding: 0 20px; margin: 15px 0; color: #000; }
        .bad-stamp { 
            position: absolute; top: 20px; right: 20px; border: 4px solid #000; color: #000; background: rgba(238, 28, 37, 0.2); 
            padding: 5px 15px; font-weight: 900; transform: rotate(-15deg); font-size: 1.8rem; border-radius: 10px;
        }

        /* Official Promo */
        .official-promo {
            margin-top: 25px; padding: 15px; background: rgba(0, 0, 0, 0.25);
            border: 2px solid rgba(255, 255, 255, 0.8); border-radius: 20px; text-align: center;
        }
        .official-promo p { margin: 0 0 10px 0; font-size: 1.1rem; color: #fff; font-weight: bold; }
        .official-btn {
            display: block; background: #fff; color: #000; text-decoration: none; padding: 15px 10px;
            border-radius: 50px; font-weight: 900; transition: 0.2s; border: 2px solid #fff; font-size: 1rem; line-height: 1.4;
        }
        .official-btn:hover { background: #000; color: #fff; border-color: #fff; transform: translateY(-2px); }

        /* Footer Credits */
        .credits { margin-top: 30px; text-align: center; color: var(--theme-text-outside); font-weight: bold; }
        .credits p { margin: 5px 0; font-size: 1.1rem; opacity: 0.9; }
        .credit-btn {
            display: inline-block; margin-top: 10px; background: rgba(0,0,0,0.3); color: #fff; text-decoration: none;
            padding: 8px 20px; border-radius: 20px; font-size: 0.9rem; transition: 0.2s; border: 1px solid rgba(255,255,255,0.5);
        }
        .credit-btn:hover { background: #fff; color: #c04000; }

        /* Capture Wrapper - æˆªåœ–å°ˆç”¨å®¹å™¨ */
        .export-wrapper {
            padding: 40px; 
            width: 100%;
            box-sizing: border-box;
            border-radius: 20px;
        }

        .toast {
            position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background: #000; color: #fff;
            padding: 15px 30px; font-weight: bold; font-size: 1.1rem; display: none; z-index: 999; border-radius: 30px; border: 2px solid #fff;
        }

        /* --- ğŸ“± Mobile Adaptive Styles (æ‰‹æ©Ÿç‰ˆè‡ªé©æ‡‰) --- */
        @media (max-width: 480px) {
            h1 { font-size: 2.2rem; }
            p.subtitle { font-size: 1.1rem; }
            
            .container { padding: 15px; }
            .card-box { padding: 20px; margin-bottom: 15px; }
            
            /* è¼¸å…¥æ¡†èˆ‡æŒ‰éˆ• */
            .input-group label { font-size: 1rem; }
            .input-name { font-size: 1.1rem; padding: 12px; }
            .btn-start, .btn-action { font-size: 1.2rem; padding: 15px 20px; }
            .mode-select-btn { font-size: 1rem; padding: 12px; }

            /* æ¸¬é©—å€ */
            .header-info { font-size: 1rem; }
            .question-card { padding: 20px; }
            .q-cat-label { font-size: 0.9rem; margin-bottom: 15px; }
            .q-text { font-size: 1.3rem; margin-bottom: 20px; }
            .option-btn { font-size: 1rem; padding: 15px; margin-bottom: 10px; }

            /* çµæœé  */
            .score-display, .bad-score { font-size: 4.5rem; }
            #rank-good, .bad-title { font-size: 1.8rem; }
            #msg-good { font-size: 1rem; }
            .bad-stamp { font-size: 1.2rem; top: 15px; right: 15px; border-width: 3px; }
            
            /* æˆªåœ–å€ (ç¢ºä¿æ‰‹æ©Ÿæˆªåœ–ä¸æœƒå¤ªæ“ ) */
            .export-wrapper { padding: 20px; }

            /* å®˜æ–¹é€£çµ */
            .official-btn { font-size: 0.9rem; padding: 12px; }
            .credit-btn { font-size: 0.8rem; }
        }
    </style>
</head>
<body>

<div class="container">
    
    <div id="screen-start" class="screen active">
        <h1>ğŸ›¡ï¸ å…¨æ°‘é˜²è¡›ç”Ÿå­˜æ¸¬é©—</h1>
        <p class="subtitle">ä½ å…·å‚™æ´»ä¸‹å»çš„çŸ¥è­˜å—ï¼Ÿ</p>

        <div class="card-box login-box">
            <div class="input-group">
                <label>è«‹è¼¸å…¥åå­— / ä»£è™Ÿ</label>
                <input type="text" id="player-name" class="input-name" placeholder="ä¾‹å¦‚ï¼šé˜¿å‰" maxlength="10">
            </div>

            <div style="text-align:left; font-size:1.2rem; margin-bottom:20px; font-weight: bold;">
                <p style="color:#000; margin-bottom: 10px;">é¸æ“‡é¡Œæ•¸ï¼š</p>
                <div style="display:flex; gap:15px;">
                    <button onclick="selectMode(10)" class="option-btn mode-select-btn">10 é¡Œ</button>
                    <button onclick="selectMode(20)" class="option-btn mode-select-btn">20 é¡Œ</button>
                </div>
            </div>

            <button id="start-btn" class="btn-start" onclick="startGame()">é–‹å§‹æ¸¬é©—</button>
        </div>

        <div class="credits">
            <p>éŠæˆ²è£½ä½œ: é˜¿å‰ YORK</p>
            <a href="https://www.threads.com/@yorkwwwwong" target="_blank" class="credit-btn">
                ğŸ‘‰ è¿½è¹¤ YORK (Threads)
            </a>
        </div>
    </div>

    <div id="screen-quiz" class="screen">
        <div class="header-info">
            <span id="quiz-player-name">Player</span>
            <span id="quiz-progress">1 / 10</span>
        </div>

        <div class="card-box question-card">
            <span class="q-cat-label" id="q-cat">é¡åˆ¥</span>
            <div id="q-text" class="q-text">é¡Œç›®è¼‰å…¥ä¸­...</div>
        </div>
        <div id="options-list" style="width:100%;"></div>
    </div>

    <div id="screen-result-good" class="screen">
        <div id="export-good" class="export-wrapper">
            <h1>ğŸ›¡ï¸ å…¨æ°‘é˜²è¡›ç”Ÿå­˜æ¸¬é©—</h1>
            <div class="card-box result-good" id="card-good">
                <div class="rank-badge">åˆæ ¼ç”Ÿå­˜è€…</div>
                <div class="score-display" id="score-good">100</div>
                <h2 id="rank-good" style="margin:0; font-size: 2.5rem;">å‚³å¥‡æŒ‡æ®å®˜</h2>
                <p style="font-size:1.4rem; margin:10px 0; font-weight: 900; color:#000;">
                    <span id="name-good" style="border-bottom:3px solid #000; padding-bottom:3px;">XXX</span> é–£ä¸‹
                </p>
                <p id="msg-good" style="font-size:1.2rem; margin:20px 0; font-weight: bold; opacity:0.8;">ä½ çš„é˜²ç½æ„è­˜æ¥µä½³<br>æ˜¯åœ‹å®¶å®‰å…¨çš„åŸºçŸ³ï¼</p>
                
                <div style="border-top:2px solid #000; padding-top:15px; font-size:1.1rem; display:flex; justify-content:space-between; font-weight: bold;">
                    <span>ç­”å°: <b id="correct-good">0</b></span>
                    <span>è€—æ™‚: <b id="time-good">0s</b></span>
                </div>
                <div style="font-size:0.9rem; margin-top:15px; opacity: 0.6;">å…¨æ°‘é˜²è¡›ç”Ÿå­˜æ¸¬é©—èªè­‰</div>
            </div>
            <div class="credits" style="margin-top: 10px;">
                <p>éŠæˆ²è£½ä½œ: é˜¿å‰ YORK</p>
            </div>
        </div>
        <button class="btn-action" onclick="downloadImage('export-good', '#C04000')">ğŸ“¸ ä¸‹è¼‰æˆ°å ±åœ–ç‰‡</button>
        <button class="btn-action btn-secondary" onclick="location.reload()">ğŸ”„ é‡æ–°æ¸¬é©—</button>

        <div class="official-promo">
            <p>ğŸ›¡ï¸ è‡ºç£å…¨æ°‘å®‰å…¨å®£å°</p>
            <a href="https://reurl.cc/Zl1Rxl" target="_blank" class="official-btn">
                ğŸ“– ä¸­è¯æ°‘åœ‹åœ‹é˜²éƒ¨å…¨æ°‘é˜²è¡›å‹•å“¡ç½²<br>ç•¶å±æ©Ÿä¾†è‡¨æ™‚ï¼šè‡ºç£å…¨æ°‘å®‰å…¨æŒ‡å¼•
            </a>
        </div>
        
        <div class="credits">
            <a href="https://www.threads.com/@yorkwwwwong" target="_blank" class="credit-btn">è¿½è¹¤ YORK</a>
        </div>
    </div>

    <div id="screen-result-bad" class="screen bad-font-style">
        <div id="export-bad" class="export-wrapper">
            <h1 class="bad-font-style">ğŸ›¡ï¸ å…¨æ°‘é˜²å«ç”Ÿå­˜æµ‹éªŒ</h1> <div class="card-box result-bad" id="card-bad">
                <div class="bad-stamp">ç»Ÿä¸€åŠŸè‡£</div>
                <div style="font-size:1.5rem; letter-spacing:1px; margin-bottom:10px; font-weight: 900; color:#000;">ç¾éš¾ç”Ÿå­˜æ™ºå•†æŒ‡æ•°</div>
                <div class="bad-score" id="score-bad">40</div>
                <div class="bad-title">é«˜åº¦å˜‰å¥–</div>
                <p style="font-size:1.3rem; line-height:1.6; margin:25px 0; font-weight: 900; color:#000;">
                    <span id="name-bad" style="border-bottom:4px solid #000; padding-bottom: 5px;">XXX</span> åŒå¿—ï¼š<br><br>
                    æ„Ÿè°¢æ‚¨å¯¹ç¥–å›½ç»Ÿä¸€å¤§ä¸šçš„è´¡çŒ®ï¼<br>
                    æ‚¨æåº¦è–„å¼±çš„é˜²ç¾æ„è¯†ï¼Œ<br>
                    å°†ä¸ºæˆ‘å†›èŠ‚çœå¤§é‡çš„æ”»å°å¼¹è¯ã€‚<br>
                    <strong style="font-size:1.6rem; margin-top:15px; display:block; text-decoration: underline;">è¯·ç»§ç»­ä¿æŒæ— çŸ¥ï¼Œåç­‰è§£æ”¾ï¼</strong>
                </p>
                <div style="font-size:1rem; margin-top:20px; font-weight: bold;">æˆ˜åŒºæ¥æ”¶å·¥ä½œå§”å‘˜ä¼š è‡´èµ </div>
            </div>
            <div class="credits" style="margin-top: 10px;">
                <p>æ¸¸æˆåˆ¶ä½œ: é˜¿å‰ YORK</p>
            </div>
        </div>
        <button class="btn-action" onclick="downloadImage('export-bad', '#EE1C25')">ğŸ“¸ ä¸‹è½½æ„Ÿè°¢çŠ¶ (å›¾ç‰‡)</button>
        <button class="btn-action btn-secondary" onclick="location.reload()">ğŸ”„ é‡æ–°å­¦ä¹ </button>

        <div class="official-promo">
            <p>ğŸ‡¹ğŸ‡¼ åªæœ‰è¿™æœ¬èƒ½æ•‘ä½  (ç‚¹æˆ‘è¡¥è¯¾)</p>
            <a href="https://reurl.cc/Zl1Rxl" target="_blank" class="official-btn">
                ğŸ“– ä¸­è¯æ°‘åœ‹åœ‹é˜²éƒ¨å…¨æ°‘é˜²è¡›å‹•å“¡ç½²<br>ç•¶å±æ©Ÿä¾†è‡¨æ™‚ï¼šè‡ºç£å…¨æ°‘å®‰å…¨æŒ‡å¼•
            </a>
        </div>
        
        <div class="credits">
            <a href="https://www.threads.com/@yorkwwwwong" target="_blank" class="credit-btn">è¿½è¸ª YORK</a>
        </div>
    </div>

</div>

<div id="toast" class="toast">åœ–ç‰‡å·²ä¸‹è¼‰ï¼</div>

<script>
    // --- é¡Œåº« (é‚è¼¯èª˜ç­” w) ---
    const fullDB = [
        // åŸºç¤èˆ‡è§€å¿µ
        { c: "åŸºç¤çŸ¥è­˜", q: "å¹³æ™‚å„²å‚™ç‰©è³‡çš„ä¸»è¦ç›®çš„ç‚ºä½•ï¼Ÿ", a: "è®“å±æ©Ÿæ™‚ä¸æ…Œäº‚ã€ç¢ºä¿åŸºæœ¬ç”Ÿå­˜éœ€æ±‚", w: ["ç‚ºäº†æ‡‰ä»˜æ”¿åºœæª¢æŸ¥", "ç‚ºäº†å›¤ç©å±…å¥‡é«˜åƒ¹è½‰è³£", "å› ç‚ºéŒ¢æ²’åœ°æ–¹èŠ±"] },
        { c: "åŸºç¤çŸ¥è­˜", q: "é¢å°å±æ©Ÿæ™‚ï¼Œå¼·èª¿ã€Œæœ‰æº–å‚™ï¼Œæ›´å®‰å…¨ã€æ˜¯ç‚ºäº†ï¼Ÿ", a: "é˜²æ­¢ææ…Œã€æå‡ç”Ÿå­˜èƒ½åŠ›", w: ["åš‡å”¬æ°‘çœ¾", "å¢åŠ è³¼ç‰©æ¶ˆè²»", "å–®ç´”çš„å£è™Ÿ"] },
        { c: "å±…å®¶å„²å‚™", q: "æ¯äººæ¯æ—¥è‡³å°‘æ‡‰æº–å‚™å¤šå°‘é£²ç”¨æ°´ï¼Ÿ", a: "3å…¬å‡", w: ["500cc (ä¸€ç“¶æ°´)", "10å…¬å‡ (å¤ªé‡)", "æœ‰å–é£²æ–™å°±å¥½"] },
        { c: "å±…å®¶å„²å‚™", q: "é—œæ–¼ã€Œå¾ªç’°å„²å‚™ã€çš„æ¦‚å¿µï¼Œä¸‹åˆ—ä½•è€…æ­£ç¢ºï¼Ÿ", a: "æ—¥å¸¸å¤šè²·ä¸€é»ï¼Œå…ˆè²·å…ˆç”¨ï¼Œéš¨æ™‚å›è£œ", w: ["è²·ä¾†é–åœ¨å€‰åº«ç›´åˆ°éæœŸ", "åªæœ‰é¢±é¢¨å¤©å»æ¶è³¼", "åªè²·ç½é ­ä¸è²·å…¶ä»–çš„"] },
        { c: "å±…å®¶å„²å‚™", q: "åœé›»å¾Œï¼Œä¸‹åˆ—å“ªå€‹è¨­å‚™é€šå¸¸æœƒã€Œå¤±æ•ˆã€ï¼Ÿ", a: "é›»å­é–èˆ‡é›»æ¢¯", w: ["å‚³çµ±æ©Ÿæ¢°é–", "ç“¦æ–¯çˆ", "æ‰‹é›»ç­’"] },
        
        // é¿é›£åŒ…
        { c: "é¿é›£åŒ…", q: "ç·Šæ€¥é¿é›£åŒ…æ‡‰æ”¾åœ¨å“ªè£¡ï¼Ÿ", a: "ç„é—œæˆ–å¤§é–€å£ç­‰éš¨æ‰‹å¯å¾—è™•", w: ["è‡¥å®¤è¡£æ«ƒæœ€æ·±è™•", "å»šæˆ¿å†°ç®±è£¡", "é™½å°é›œç‰©å †"] },
        { c: "é¿é›£åŒ…", q: "ç”·æ€§é¿é›£åŒ…å»ºè­°é‡é‡ä¸Šé™ï¼Ÿ", a: "15å…¬æ–¤", w: ["5å…¬æ–¤", "30å…¬æ–¤", "æ„ˆé‡æ„ˆå¥½"] },
        { c: "é¿é›£åŒ…", q: "é¿é›£åŒ…å…§æº–å‚™ã€Œæ”¶éŸ³æ©Ÿã€æ˜¯ç‚ºäº†ï¼Ÿ", a: "ç¶²è·¯æ–·è¨Šæ™‚æ¥æ”¶æ”¿åºœè³‡è¨Š", w: ["ç„¡èŠè½éŸ³æ¨‚", "ç™¼å‡ºæ±‚æ•‘è¨Šè™Ÿ", "ç•¶ä½œè¡Œå‹•é›»æº"] },
        
        // è­¦å ±èˆ‡æ‡‰è®Š
        { c: "è­¦å ±é¿é›£", q: "é˜²ç©ºè­¦å ±ã€Œè§£é™¤ã€çš„è²éŸ³ç‰¹å¾µï¼Ÿ", a: "ä¸€é•·è²ï¼ŒæŒçºŒ90ç§’", w: ["æ€¥ä¿ƒçŸ­è²", "å®Œå…¨æ²’è²éŸ³", "åªæœ‰å»£æ’­äººè²"] },
        { c: "è­¦å ±é¿é›£", q: "æˆ¶å¤–é­é‡ç©ºè¥²çˆ†ç‚¸æ™‚çš„å§¿å‹¢ï¼Ÿ", a: "èƒŒå‘çˆ†ç‚¸ã€è¶´ä¸‹ã€é®çœ¼æ©è€³ã€å˜´å¾®å¼µ", w: ["æ‹¿æ‰‹æ©ŸéŒ„å½±", "ç«™ç«‹ä¸å‹•", "æ‹”è…¿ç‹‚å¥”"] },
        { c: "è­¦å ±é¿é›£", q: "è½åˆ°æµ·å˜¯è­¦å ±ï¼Œæ‡‰å¾€å“ªè£¡è·‘ï¼Ÿ", a: "å¾€é«˜è™•ã€å¾€å…§é™¸ç§»å‹•", w: ["å»æµ·é‚Šçœ‹æµª", "èº²åœ¨åœ°ä¸‹å®¤", "é–‹è»Šä¸Šé«˜é€Ÿå…¬è·¯"] },
        
        // æ€¥æ•‘
        { c: "æ€¥æ•‘äº’æ•‘", q: "å¤§é‡å‡ºè¡€æ™‚æœ€å„ªå…ˆçš„æ­¢è¡€æ³•ï¼Ÿ", a: "ç›´æ¥åŠ å£“æ­¢è¡€", w: ["ç¶æ­¢è¡€å¸¶", "æ²–å†·æ°´", "æŠ¬é«˜æ‚£è‚¢"] },
        { c: "æ€¥æ•‘äº’æ•‘", q: "æ‡·ç–‘è„Šæ¤éª¨æŠ˜æ™‚ï¼Ÿ", a: "ä¸å¯éš¨æ„ç§»å‹•ï¼Œç­‰å¾…æ•‘æ´", w: ["ç«‹åˆ»æ¹èµ·ä¾†é€é†«", "å¹«ä»–æŒ‰æ‘©", "æ‰¶ä»–åèµ·ä¾†"] },
        { c: "æ€¥æ•‘äº’æ•‘", q: "æ¯’æ°£(åŒ–å­¸ç½å®³)å¤–æ´©æ™‚ï¼Œå¾€å“ªé¿é›£ï¼Ÿ", a: "ä¸Šé¢¨è™•", w: ["ä¸‹é¢¨è™•", "ä½çªªè™•", "åœ°ä¸‹å®¤"] },

        // æˆ°æ™‚èˆ‡è³‡å®‰
        { c: "è»äº‹æ‡‰è®Š", q: "çœ‹åˆ°ä¸æ˜æ­¦è£éƒ¨éšŠæ™‚ï¼Ÿ", a: "ä¿æŒå†·éœã€ä¸æŒ‘é‡ã€é›¢é–‹ä¸¦é€šå ±", w: ["æ‹ç…§ä¸Šå‚³æ‰“å¡", "ä¸Šå‰è©¢å•", "å˜—è©¦æ”»æ“Š"] },
        { c: "è»äº‹æ‡‰è®Š", q: "ç‚ºä½•ä¸èƒ½æ‹æ”æˆ‘è»å‹•æ…‹ä¸Šå‚³ï¼Ÿ", a: "æœƒæš´éœ²ä½ç½®ï¼Œè³‡æ•µä¸”é•æ³•", w: ["å› ç‚ºé˜¿å…µå“¥å®³ç¾", "æ‰‹æ©Ÿç•«è³ªå¤ªå·®", "æµé‡ä¸å¤ "] },
        { c: "è³‡è¨Šå®‰å…¨", q: "è¾¨è­˜å‡è¨Šæ¯çš„ã€Œ3ä¸1è¦ã€ï¼Œ1è¦æ˜¯æŒ‡ï¼Ÿ", a: "è¦æŸ¥è­‰", w: ["è¦è½‰å‚³", "è¦æŒ‰è®š", "è¦ææ…Œ"] },
        { c: "è³‡è¨Šå®‰å…¨", q: "è·¯é‚Šä¸æ˜ QR Code å¯ä»¥æƒå—ï¼Ÿ", a: "ä¸å¯ï¼Œå¯èƒ½å«æƒ¡æ„ç¨‹å¼", w: ["å¯ä»¥ï¼Œå¯èƒ½æ˜¯å„ªæƒ åˆ¸", "çœ‹åœ–ç‰‡æ¼‚äº®å°±æƒ", "æƒå®Œç«‹åˆ»é—œæ‰å°±å¥½"] },
        { c: "æ°‘ç”Ÿå±…ä½", q: "åœé›»æ™‚å†°ç®±æ‡‰å¦‚ä½•è™•ç½®ï¼Ÿ", a: "å°‘é–‹é–€ï¼Œç¶­æŒå…§éƒ¨ä½æº«", w: ["æ‰“é–‹é€šé¢¨", "æ‹”æ‰æ’é ­", "æŠŠé£Ÿç‰©æ‹¿å‡ºä¾†"] }
    ];

    let playerName = "";
    let questionCount = 10;
    let currentQuestions = [];
    let currentIndex = 0;
    let score = 0;
    let startTime = 0;
    let selectedMode = 0;

    function selectMode(n) {
        questionCount = n;
        document.querySelectorAll('.mode-select-btn').forEach(b => {
            b.style.background = '#fff';
            b.style.color = '#000';
            b.style.borderColor = '#000';
        });
        event.target.style.background = '#000';
        event.target.style.color = '#fff';
        selectedMode = n;
    }

    function startGame() {
        const input = document.getElementById('player-name');
        if (!input.value.trim()) {
            alert("è«‹è¼¸å…¥åå­—æ‰èƒ½é–‹å§‹ï¼");
            return;
        }
        if (selectedMode === 0) selectMode(10);

        playerName = input.value.trim();
        document.getElementById('quiz-player-name').innerText = playerName;

        // æº–å‚™é¡Œç›® (DEMOç”¨)
        let pool = JSON.parse(JSON.stringify(fullDB));
        while(pool.length < questionCount) pool = pool.concat(fullDB);
        
        currentQuestions = pool.sort(() => Math.random() - 0.5).slice(0, questionCount);
        
        currentIndex = 0;
        score = 0;
        startTime = Date.now();

        showScreen('screen-quiz');
        loadQuestion();
    }

    function showScreen(id) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
    }

    function loadQuestion() {
        const qData = currentQuestions[currentIndex];
        document.getElementById('quiz-progress').innerText = `${currentIndex + 1} / ${questionCount}`;
        document.getElementById('q-cat').innerText = qData.c;
        document.getElementById('q-text').innerText = qData.q;

        let opts = [{t: qData.a, correct: true}];
        let wrongs = qData.w ? [...qData.w] : ["éŒ¯èª¤é¸é …A", "éŒ¯èª¤é¸é …B", "éŒ¯èª¤é¸é …C"];
        wrongs.sort(() => Math.random() - 0.5).slice(0, 3).forEach(w => opts.push({t: w, correct: false}));
        opts.sort(() => Math.random() - 0.5);

        const list = document.getElementById('options-list');
        list.innerHTML = "";
        opts.forEach(opt => {
            let btn = document.createElement('div');
            btn.className = 'option-btn';
            btn.innerText = opt.t;
            btn.onclick = () => checkAnswer(btn, opt.correct, qData.a);
            list.appendChild(btn);
        });
    }

    function checkAnswer(btn, isCorrect, correctTxt) {
        const all = document.querySelectorAll('.option-btn');
        all.forEach(b => b.style.pointerEvents = 'none');

        if(isCorrect) {
            btn.classList.add('correct');
            score++;
        } else {
            btn.classList.add('wrong');
            all.forEach(b => {
                if(b.innerText === correctTxt) b.classList.add('correct');
            });
        }

        setTimeout(() => {
            currentIndex++;
            if(currentIndex < questionCount) loadQuestion();
            else endGame();
        }, 1500);
    }

    function endGame() {
        let finalScore = Math.round((score / questionCount) * 100);
        let timeUsed = Math.floor((Date.now() - startTime) / 1000);

        if (finalScore >= 60) {
            // Good
            showScreen('screen-result-good');
            document.getElementById('score-good').innerText = finalScore;
            document.getElementById('correct-good').innerText = score;
            document.getElementById('time-good').innerText = timeUsed + "s";
            document.getElementById('name-good').innerText = playerName; 
            
            let rank = "ç”Ÿå­˜è€…";
            if(finalScore === 100) rank = "å‚³å¥‡æŒ‡æ®å®˜";
            else if(finalScore >= 80) rank = "ç”Ÿå­˜å°ˆå®¶";
            document.getElementById('rank-good').innerText = rank;

        } else {
            // Bad (Satire)
            document.body.classList.add('bad-end'); 
            showScreen('screen-result-bad');
            document.getElementById('score-bad').innerText = finalScore;
            document.getElementById('name-bad').innerText = playerName;
        }
    }

    function showToast(msg) {
        const toast = document.getElementById('toast');
        toast.innerText = msg;
        toast.style.display = 'block';
        setTimeout(() => toast.style.display = 'none', 3000);
    }

    function downloadImage(elementId, bgColor) {
        const element = document.getElementById(elementId);
        const btn = event.target;
        const originalText = btn.innerText;
        
        btn.innerText = "ğŸ”„ åœ–ç‰‡ç”Ÿæˆä¸­...";
        btn.disabled = true;

        // æ‰‹æ©Ÿç‰ˆæˆªåœ–æ™‚ï¼Œæš«æ™‚å°‡å¯¬åº¦é–å®šç‚º 600px ä»¥ç²å¾—æ¸…æ™°çš„æµ·å ±æ¯”ä¾‹
        const originalWidth = element.style.width;
        element.style.width = "600px"; 

        html2canvas(element, {
            scale: 2,
            useCORS: true,
            backgroundColor: bgColor,
            windowWidth: 1200 // è™›æ“¬è¦–çª—å¯¬åº¦ï¼Œç¢ºä¿æˆªåœ–ä¸è·‘ç‰ˆ
        }).then(canvas => {
            element.style.width = originalWidth; // æ¢å¾©åŸç‹€

            const link = document.createElement('a');
            link.download = `ç”Ÿå­˜æ¸¬é©—æˆ°å ±_${playerName}.png`;
            link.href = canvas.toDataURL("image/png");
            link.click();
            
            btn.innerText = originalText;
            btn.disabled = false;
            showToast("åœ–ç‰‡å·²ä¸‹è¼‰ï¼");
        }).catch(err => {
            console.error("ç”Ÿæˆå¤±æ•—:", err);
            element.style.width = originalWidth;
            btn.innerText = "âŒ å¤±æ•—";
            setTimeout(() => {
                btn.innerText = originalText;
                btn.disabled = false;
            }, 2000);
        });
    }
</script>

</body>
</html>